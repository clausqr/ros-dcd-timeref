<?xml version="1.0"?>
<launch>
  <!-- Arguments -->
  <arg name="pps_device" default="/dev/pps0" doc="PPS device path"/>
  <arg name="edge" default="assert" doc="Edge detection: assert, clear, or both"/>
  <arg name="source" default="DCD_PPS" doc="Source identifier for messages"/>
  <arg name="frame_id" default="lidar_trigger_time" doc="Frame ID for message headers"/>
  <arg name="publish_both_edges" default="false" doc="Publish on both edges"/>
  <arg name="use_header_stamp_now" default="true" doc="Use current time for header stamp"/>
  <arg name="queue_size" default="10" doc="Publisher queue size"/>
  <arg name="rate" default="100.0" doc="Publishing rate (Hz)"/>
  <arg name="timeout_sec" default="1.0" doc="Timeout for PPS operations"/>
  
  <!-- Main dcd_timeref node with explicit environment setup -->
  <node name="dcd_timeref" pkg="dcd_timeref" type="dcd_timeref" 
        output="screen" respawn="true" 
        launch-prefix="bash -c 'export LD_LIBRARY_PATH=/opt/ros/noetic/lib:$LD_LIBRARY_PATH; exec '">
    <param name="pps_device" value="$(arg pps_device)"/>
    <param name="edge" value="$(arg edge)"/>
    <param name="source" value="$(arg source)"/>
    <param name="frame_id" value="$(arg frame_id)"/>
    <param name="publish_both_edges" value="$(arg publish_both_edges)"/>
    <param name="use_header_stamp_now" value="$(arg use_header_stamp_now)"/>
    <param name="queue_size" value="$(arg queue_size)"/>
    <param name="rate" value="$(arg rate)"/>
    <param name="timeout_sec" value="$(arg timeout_sec)"/>
  </node>
</launch>
